
# Kingsguard
agot_kingsguard_elective_negative_modifier = {
	modifier = {
		NOT = { this = scope:candidate } #Not on yourself.
		save_temporary_opinion_value_as = {
			name = opinion_of_candidate
			target = scope:candidate
		}
		scope:opinion_of_candidate <= low_negative_opinion
			add = {
				subtract = 15
				if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -80
						}
					}
					subtract = 35
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -50
						}
					}
					subtract = 20
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -30
						}
					}
					subtract = 10
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -10
						}
					}
					subtract = 5
				}
				if = { #Even less so if rival.
					limit = {
						has_relation_rival = scope:candidate
					}
					subtract = 15
				}
			}
	}
}
agot_kingsguard_elective_positive_modifier = {
	modifier = {
		NOT = {
			has_relation_rival = scope:candidate #Completely removed for rivals.
		}
		NOT = { this = scope:candidate } #Not on yourself.
		save_temporary_opinion_value_as = {
			name = opinion_of_candidate
			target = scope:candidate
		}
		scope:opinion_of_candidate >= low_positive_opinion
			add = {
				value = 15
				if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 10
						}
					}
					add = 5
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 30
						}
					}
					add = 5
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 50
						}
					}
					add = 10
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 80
						}
					}
					add = 15
				}
				if = { #Even more so if friend/lover.
					limit = {
						OR = {
							has_relation_friend = scope:candidate
							has_relation_lover = scope:candidate
						}
					}
					add = 15
				}
			}
	}
}

# Nights watch
agot_nights_watch_elective_negative_modifier = {
	modifier = {
		NOT = { this = scope:candidate } #Not on yourself.
		save_temporary_opinion_value_as = {
			name = opinion_of_candidate
			target = scope:candidate
		}
		scope:opinion_of_candidate <= low_negative_opinion
			add = {
				subtract = 15
				if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -80
						}
					}
					subtract = 35
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -50
						}
					}
					subtract = 20
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -30
						}
					}
					subtract = 10
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -10
						}
					}
					subtract = 5
				}
				if = { #Even less so if rival.
					limit = {
						has_relation_rival = scope:candidate
					}
					subtract = 15
				}
			}
	}
}
agot_nights_watch_elective_positive_modifier = {
	modifier = {
		NOT = {
			has_relation_rival = scope:candidate #Completely removed for rivals.
		}
		NOT = { this = scope:candidate } #Not on yourself.
		save_temporary_opinion_value_as = {
			name = opinion_of_candidate
			target = scope:candidate
		}
		scope:opinion_of_candidate >= low_positive_opinion
			add = {
				value = 15
				if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 10
						}
					}
					add = 5
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 30
						}
					}
					add = 5
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 50
						}
					}
					add = 10
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 80
						}
					}
					add = 15
				}
				if = { #Even more so if friend/lover.
					limit = {
						OR = {
							has_relation_friend = scope:candidate
							has_relation_lover = scope:candidate
						}
					}
					add = 15
				}
			}
	}
}

# Silent sisters
agot_silent_sisterhood_elective_negative_modifier = {
	modifier = {
		NOT = { this = scope:candidate } #Not on yourself.
		save_temporary_opinion_value_as = {
			name = opinion_of_candidate
			target = scope:candidate
		}
		scope:opinion_of_candidate <= low_negative_opinion
			add = {
				subtract = 15
				if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -80
						}
					}
					subtract = 35
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -50
						}
					}
					subtract = 20
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -30
						}
					}
					subtract = 10
				}
				else_if = { #Even less so if lower opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value <= -10
						}
					}
					subtract = 5
				}
				if = { #Even less so if rival.
					limit = {
						has_relation_rival = scope:candidate
					}
					subtract = 15
				}
			}
	}
}
agot_silent_sisterhood_elective_positive_modifier = {
	modifier = {
		NOT = {
			has_relation_rival = scope:candidate #Completely removed for rivals.
		}
		NOT = { this = scope:candidate } #Not on yourself.
		save_temporary_opinion_value_as = {
			name = opinion_of_candidate
			target = scope:candidate
		}
		scope:opinion_of_candidate >= low_positive_opinion
			add = {
				value = 15
				if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 10
						}
					}
					add = 5
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 30
						}
					}
					add = 5
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 50
						}
					}
					add = 10
				}
				else_if = { #Even more so if higher opinion.
					limit = {
						opinion = {
							target = scope:candidate
							value >= 80
						}
					}
					add = 15
				}
				if = { #Even more so if friend/lover.
					limit = {
						OR = {
							has_relation_friend = scope:candidate
							has_relation_lover = scope:candidate
						}
					}
					add = 15
				}
			}
	}
}

agot_elector_voting_pattern_prestige_pirate_elective_modifier = {
	##########################	Elector voting patterns (prestige/piety)	##########################
	#Prestige
	modifier = {
		desc = tooltip_feudal_elector_vote_prestige_negative
		add = -10
		NOT = { this = scope:candidate }
		scope:candidate = { prestige_level < 1 }
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_prestige_positive
		add = {
			value = scope:candidate.prestige_level
			subtract = 1
			multiply = 5
		}
		NOT = { this = scope:candidate }
		scope:candidate = { prestige_level >= 2 }
	}
}

agot_elector_voting_pattern_circumstances_pirate_elective_modifier = {
	##########################	Elector voting patterns (circumstances)	##########################
	#Sexism
	modifier = { #Gender weights
		desc = tooltip_feudal_elector_vote_agnatic_woman
		OR = {
			scope:title = { #Title might have different law than realm's.
				has_title_law = male_preference_law
			}
			AND = { #If title has neither the required law nor its opposites, check for realm law.
				scope:holder = { has_realm_law = male_preference_law }
				scope:title = {
					NOR = {
						has_title_law = female_preference_law
						has_title_law = equal_law
					}
				}
			}
			faith = { has_doctrine = doctrine_gender_male_dominated }
		}
		scope:candidate = { is_female = yes }
		add = {
			subtract = 100
			if = { #Increase if both.
				limit = {
					OR = {
						scope:title = { #Title might have different law than realm's.
							has_title_law = male_preference_law
						}
						AND = { #If title has neither the required law nor its opposites, check for realm law.
							scope:holder = { has_realm_law = male_preference_law }
							scope:title = {
								NOR = {
									has_title_law = female_preference_law
									has_title_law = equal_law
								}
							}
						}
					}
					faith = { has_doctrine = doctrine_gender_male_dominated }
				}
				multiply = 1.5
			}
			if = { #Halve if talking about myself.
				limit = {
					this = scope:candidate
					scope:candidate = scope:holder_candidate
				}
				multiply = 0.5
			}
		}
	}
	modifier = { #Gender weights
		desc = tooltip_feudal_elector_vote_enatic_man
		OR = {
			scope:title = { #Title might have different law than realm's.
				has_title_law = female_preference_law
			}
			AND = { #If title has neither the required law nor its opposites, check for realm law.
				scope:holder = { has_realm_law = female_preference_law }
				scope:title = {
					NOR = {
						has_title_law = male_preference_law
						has_title_law = equal_law
					}
				}
			}
			faith = { has_doctrine = doctrine_gender_female_dominated }
		}
		scope:candidate = {
			is_female = no
		}
		add = {
			subtract = 100
			if = { #Increase if both.
				limit = {
					OR = {
						scope:title = { #Title might have different law than realm's.
							has_title_law = female_preference_law
						}
						AND = { #If title has neither the required law nor its opposites, check for realm law.
							scope:holder = { has_realm_law = female_preference_law }
							scope:title = {
								NOR = {
									has_title_law = male_preference_law
									has_title_law = equal_law
								}
							}
						}
					}
					faith = { has_doctrine = doctrine_gender_female_dominated }
				}
				multiply = 1.5
			}
			if = { #Halve if talking about myself.
				limit = {
					this = scope:candidate
					scope:candidate = scope:holder_candidate
				}
				multiply = 0.5
			}
		}
	}
	#Ageism
	modifier = {
		add = -1000
		desc = tooltip_feudal_elector_vote_baby
		NOT = { this = scope:candidate }
		scope:candidate = {
			age < 10
		}
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_child
		NOT = { this = scope:candidate }
		scope:candidate = {
			age > 9
			age < 16
		}
		add = {
			subtract = 25
			if = {
				limit = {
					age < 14
				}
				subtract = 25
			}
		}
	}
	modifier = { #Still too young for older rulers
		add = -10
		desc = tooltip_feudal_elector_vote_youngster
		NOT = { this = scope:candidate }
		age > 40
		scope:candidate = {
			age > 16
			age < 25
		}
	}
	modifier = { #Or too old for younger rulers.
		add = -10
		desc = tooltip_feudal_elector_vote_oldtimer
		NOT = { this = scope:candidate }
		age < 30
		scope:candidate = {
			age > 40
			age < 50
		}
	}
	modifier = { #Or simply too old overall.
		add = -15
		desc = tooltip_feudal_elector_vote_decrepit
		NOT = { this = scope:candidate }
		scope:candidate = { age > 50 }
	}
	modifier = { #Candidate is a foreigner's pet
		desc = tooltip_feudal_elector_vote_strangers_pet
		scope:candidate = {
			this = scope:holder_candidate
			NOT = { this.culture = root.culture }
			culture = { has_same_culture_heritage = root.culture }
			this.culture = scope:holder.culture
		}
		NOT = { is_close_family_of = scope:candidate }
		add = -10
	}
	#Nepotism
	modifier = {
		add = 10
		desc = tooltip_feudal_elector_vote_dynasty
		NOT = { this = scope:candidate }
		exists = root.dynasty
		exists = scope:candidate.dynasty
		root.dynasty = scope:candidate.dynasty
		scope:candidate = {
			NOT = { is_close_family_of = root }
		}
	}
	modifier = {
		add = 20
		desc = tooltip_feudal_elector_vote_relative
		NOT = { this = scope:candidate }
		scope:candidate = {
			is_close_family_of = root
			NOT = { is_child_of = root }
		}
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_parent
		NOT = { this = scope:candidate }
		scope:candidate = { is_child_of = root }
		add = {
			value = 30
			if = { #Current Ruler should tend to often pick one of his own children as potential heirs.
				limit = { this = scope:holder }
				add = 30
			}
		}
	}
	modifier = { #Elector AI should not pick current ruler's distant relatives
		add = -75
		desc = tooltip_feudal_elector_vote_distant_relative
		NOR = {
			this = scope:candidate
			is_close_family_of = root
			scope:candidate = scope:holder_candidate #Avoid if he's being specifically picked by the current ruler.
		}
		exists = scope:candidate.dynasty
		exists = scope:holder.dynasty
		scope:candidate = { #Candidate in question must not be of the same house as the Elector.
			dynasty = scope:holder.dynasty
			NOT = {
				house = root.house
			}
		}
	}
	#Educational preferences
	modifier = { # Warrior society prefers warriors
		desc = tooltip_feudal_elector_vote_martial_education
		NOT = { this = scope:candidate }
		scope:candidate = {
			martial >= 10
			OR = {
				has_trait = education_martial
				has_lifestyle = martial_lifestyle
				has_trait = lifestyle_blademaster
				has_martial_lifestyle_trait_trigger = yes
			}
		}
		add = 50
	}
	# Political Circumstances
	modifier = {
		add = {
			if = {
				limit = {
					scope:holder = { has_diarchy_parameter = diarchy_type_is_temporary_regency }
				}
				add = 20
			}
			else = { add = 40 }
		}
		desc = tooltip_feudal_elector_vote_regent_already_governs
		NOT = { this = scope:candidate }
		scope:candidate = { is_diarch_of_target = scope:holder }
	}
}

agot_elector_voting_pattern_traits_pirate_elective_modifier = {
	##########################	Elector voting patterns (traits)	##########################
	#Personality Traits compatibility
	#Sins vs Virtues
	#Crime traits
	#Attraction
	#Special cases (ex. deformities, disfigured for Byzantines)

	#Trait compatibility between elector and candidate
	compatibility_modifier = {
		who = root
		compatibility_target = scope:candidate
		min = -50
		max = 50
		trigger = {
			NOT = { root = scope:candidate }
		}
	}
	#Attraction
	modifier = {
		desc = tooltip_feudal_elector_vote_attractive
		NOT = { this = scope:candidate } #Do not judge yourself, you dirty AI.
		is_adult = yes
		scope:candidate = {
			is_adult = yes
			attraction >= 25
		}
		add = {
			value = 1
			multiply = scope:candidate.attraction
			multiply = 0.1
		}
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_ugly
		NOT = { this = scope:candidate } #Do not judge yourself.
		is_adult = yes
		scope:candidate = {
			is_adult = yes
			attraction <= -25
		}
		add = {
			value = 0
			multiply = scope:candidate.attraction
			multiply = 0.1
		}
	}

	#Special cases (ex. deformities, disfigured for Byzantines)
	modifier = {
		desc = tooltip_feudal_elector_vote_incapable_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = incapable }
		add = -50
	}
	modifier = {
		add = -15
		desc = tooltip_feudal_elector_vote_infirm
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = infirm }
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_disfigured_warrior
		scope:candidate = { has_trait = disfigured }
		add = -5
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_maimed_warrior
		scope:candidate = { has_trait = maimed }
		add = -15
	}
	modifier = {
		desc = tooltip_pirate_elector_vote_strong
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = {
			OR = {
				has_trait = physique_good
				has_trait = strong
			}
		}
		add = {
			value = 0
			if = {
				limit = {
					scope:candidate = { has_trait = physique_good_1 }
				}
				add = 25
			}
			if = {
				limit = {
					scope:candidate = {
						OR = {
							has_trait = strong
							has_trait = physique_good_2
						}
					}
				}
				add = 25
			}
			if = {
				limit = {
					scope:candidate = { has_trait = physique_good_3 }
				}
				add = 25
			}
		}
	}
	modifier = {
		desc = tooltip_pirate_elector_vote_weak
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = {
			OR = {
				has_trait = physique_bad
				has_trait = weak
			}
		}
		add = {
			value = 0
			if = {
				limit = {
					scope:candidate = { has_trait = physique_bad_1 }
				}
				add = -25
			}
			if = {
				limit = {
					scope:candidate = {
						OR = {
							has_trait = weak
							has_trait = physique_bad_2
						}
					}
				}
				add = -25
			}
			if = {
				limit = {
					scope:candidate = { has_trait = physique_bad_3 }
				}
				add = -25
			}
		}
	}
	modifier = {
		desc = tooltip_pirate_elector_vote_strong_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { prowess >= 20 }
		add = {
			value = 10
			if = {
				limit = {
					scope:candidate = { prowess >= 25 }
				}
				add = 10
			}
			if = {
				limit = {
					scope:candidate = { prowess >= 30 }
				}
				add = 10
			}
			if = {
				limit = {
					scope:candidate = { prowess >= 35 }
				}
				add = 10
			}
			if = {
				limit = {
					scope:candidate = { prowess >= 40 }
				}
				add = 10
			}
			if = {
				limit = {
					scope:candidate = { prowess >= 45 }
				}
				add = 10
			}
			if = {
				limit = {
					scope:candidate = { prowess >= 50 }
				}
				add = 10
			}
		}
	}
	modifier = {
		desc = tooltip_pirate_elector_vote_pathetic_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { prowess < 10 }

		add = -25
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_clubfooted
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = clubfooted }
		add = -5
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_dwarf_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = dwarf }
		add = -30
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_hunchback_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = hunchbacked }
		add = -30
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_inbred
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = {
			OR = {
				has_trait = inbred
				has_trait = spindly
				has_trait = scaly
				has_trait = albino
				has_trait = wheezing
				has_trait = bleeder
			}
		}
		add = -15
	}
	modifier = {
		desc = tooltip_feudal_elector_vote_lisping
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = lisping }
		add = -5
	}
	modifier = {
		add = -5
		desc = tooltip_feudal_elector_vote_stuttering
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = stuttering }
	}
	modifier = { #Shunned for being a lunatic
		add = -15
		desc = tooltip_feudal_elector_vote_lunatic_negative
		NOT = { this = scope:candidate } #Do not judge yourself.
		OR = {
			has_trait = arbitrary #No need for consistency
			NOR = {
				has_trait = lunatic
				has_trait = possessed
			}
		}
		scope:candidate = { has_trait = lunatic }
	}
	modifier = { #Shunned for being possessed
		add = -15
		desc = tooltip_feudal_elector_vote_possessed_negative
		NOR = {
			this = scope:candidate	#Do not judge yourself.
			faith = { has_doctrine_parameter = spirit_possession_active }
		}
		OR = {
			has_trait = arbitrary #No need for consistency
			NOR = {
				has_trait = lunatic
				has_trait = possessed
			}
		}
		scope:candidate = { has_trait = possessed }
	}
	modifier = { #Praised for being possessed
		add = 35
		desc = tooltip_feudal_elector_vote_possessed_positive
		NOT = { this = scope:candidate } #Do not judge yourself.
		faith = { has_doctrine_parameter = spirit_possession_active }
		ai_zeal > 10
		scope:candidate = { has_trait = possessed }
	}
	modifier = { #Praised for being Adventurer
		add = 10
		desc = tooltip_feudal_elector_vote_adventurer_positive
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = adventurer }
	}
	modifier = { #Praised for being Berserker
		add = 5
		desc = tooltip_feudal_elector_vote_berserker_positive
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = berserker }
	}
	modifier = { #Shunned for being blind
		desc = tooltip_feudal_elector_vote_blinded_negative_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = blind }
		add = -20
	}
	modifier = { #Shunned for being eunuch
		desc = tooltip_feudal_elector_vote_eunuch_negative_warrior
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = eunuch }
		add = -50
	}
	modifier = { #Praised for being Giant
		add = 25
		desc = tooltip_feudal_elector_vote_giant_positive
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = { has_trait = giant }
	}
	modifier = { #Shunned for being unproved courtier in the shadow of the ruler.
		add = -10
		desc = tooltip_feudal_elector_vote_spoiled_courtier
		scope:candidate = { this = scope:holder_candidate }
		NOT = { this = scope:candidate } #Do not judge yourself.
		scope:candidate = {
			NOR = {
				is_ruler = yes
				has_council_position = councillor_marshal
				has_council_position = councillor_chancellor
				has_council_position = councillor_steward
				has_council_position = councillor_spymaster
				has_council_position = councillor_court_chaplain
			}
			OR = {
				has_trait = lazy
				has_trait = shy
			}
		}
	}
}
