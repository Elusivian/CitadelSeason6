namespace = agot_peake_uprising

agot_peake_uprising.0001 = { # Peake Introductory Event

	title = agot_peake_uprising.0001.t
	desc = agot_peake_uprising.0001.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_honorable
		outfit_tags = {
			stormlander_armor
		}
	}
	right_portrait = {
		character = character:Targaryen_110
		animation = aggressive_mace
		outfit_tags = {
			valyrian_armor
		}
	}

	immediate = {
		#title:e_blackfyre_rebellion.holder = { save_scope_as = blackfyre }
		character:Targaryen_94 = { save_scope_as = daemon }
		character:Targaryen_91 = { save_scope_as = daeron }
		character:Blackfyre_7 = { save_scope_as = aenysclaimant }
	}

	option = { # To whatever end...
		name = agot_peake_uprising.0001.a
	}
}

agot_peake_uprising.0002 = { # Maekar Introductory Event

	title = agot_peake_uprising.0002.t
	desc = agot_peake_uprising.0002.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
		outfit_tags = {
			valyrian_armor
		}
	}
	right_portrait = {
		character = character:Peake_66
		animation = aggressive_axe
		outfit_tags = {
			stormlander_armor
		}
	}
	immediate = {
		title:b_starpike.holder = { save_scope_as = peake }
		character:Blackfyre_7 = { save_scope_as = aenysclaimant }
	}

	option = { # How many times must I teach you this lesson, old man?
		name = agot_peake_uprising.0002.a
	}
}

agot_peake_uprising.0003 = { # Robert Reyne Introductory Event

	title = agot_peake_uprising.0003.t
	desc = agot_peake_uprising.0003.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
		outfit_tags = {
			westerlander_armor
		}
	}
	right_portrait = {
		character = character:Peake_66
		animation = aggressive_axe
		outfit_tags = {
			stormlander_armor
		}
	}

	immediate = {
		title:b_starpike.holder = { save_scope_as = peake }
		title:b_summerhall.holder = { save_scope_as = egg }
		title:e_the_iron_throne.holder = { save_scope_as = maekar }
		title:c_casterly_rock.holder = { save_scope_as = gerold }
	}

	option = { # We ride south at dawn.
		name = agot_peake_uprising.0003.a
	}
}

agot_peake_uprising.0004 = { # Prince Aegon Introductory Event

	title = agot_peake_uprising.0004.t
	desc = agot_peake_uprising.0004.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_compassionate
		outfit_tags = {
			valyrian_armor
		}
	}
	right_portrait = {
		character = character:Peake_66
		animation = aggressive_axe
		outfit_tags = {
			stormlander_armor
		}
	}
	immediate = {
		title:b_starpike.holder = { save_scope_as = peake }
		#title:e_blackfyre_rebellion.holder = { save_scope_as = blackfyre }
		title:e_the_iron_throne.holder = { save_scope_as = maekar }
		character:Blackfyre_7 = { save_scope_as = aenysclaimant }
	}

	option = { # I pray for as little bloodshed as possible
		name = agot_peake_uprising.0004.a
	}
}

agot_peake_uprising.0005 = { # Storming of Starpike

	title = agot_peake_uprising.0005.t
	desc = agot_peake_uprising.0005.desc
	theme = war
	left_portrait = {
		character = root
		animation = aggressive_mace
		outfit_tags = {
			valyrian_armor
		}
	}
	right_portrait = {
		character = character:Peake_66
		animation = shock
		outfit_tags = {
			stormlander_armor
		}
	}

	immediate = {
		title:b_starpike.holder = { save_scope_as = peake }
		title:b_summerhall.holder = { save_scope_as = egg }
		title:c_castamere.holder = { save_scope_as = reyne }
	}


	option = { # Begin the assault!
		name = agot_peake_uprising.0005.a
		add_character_modifier = {
			modifier = castle_storming_event_modifier
			days = 60
		}
		title:b_starpike.title_province = {
			add_province_modifier  = {
				modifier = castle_storming_fort_level_event_modifier
				days = 60
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_historic_outcome_2 }
		}
	}
	option = { # Maintain the siege
		name = agot_peake_uprising.0005.b
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_2 }
		}
	}
}

agot_peake_uprising.0006 = { # The Storming of Starpike - Maekar survives

	title = agot_peake_uprising.0006.t
	desc = agot_peake_uprising.0006.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_compassionate
		outfit_tags = {
			valyrian_armor
		}
	}
	right_portrait = {
		character = title:b_starpike.holder
		animation = aggressive_axe
		outfit_tags = {
			stormlander_armor
		}
	}


	immediate = {
		root = {
			save_scope_as = maekar
		}
		title:b_starpike = {
			save_scope_as = location
		}
		scope:location.holder = {
			if = {
				limit = {
					location = scope:location.title_province
					NOR = {
						exists = commanding_army
						exists = knight_army
						is_imprisoned = yes
					}
					dynasty = dynasty:dynn_Peake
				}
				add_to_list = besieged_characters
			}
			every_courtier_or_guest = {
				limit = {
					location = scope:location.title_province
					NOR = {
						exists = commanding_army
						exists = knight_army
						is_imprisoned = yes
					}
					dynasty = dynasty:dynn_Peake
				}
				add_to_list = besieged_characters
			}
		}
		title:b_starpike.holder = {
			save_scope_as = peake
		}
	}


	option = { # Do nothing for now
		name = agot_peake_uprising.0006.a
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_3 }
		}
	}

	option = { # Take Lord Peake's head
		name = agot_peake_uprising.0006.b
		add_dread = medium_dread_gain
		title:b_starpike.holder = {
			death = {
				death_reason = death_execution
				killer = root
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_historic_outcome_3 }
		}
	}

	option = { # Kill them all!
		name = agot_peake_uprising.0006.c
		add_dread = massive_dread_gain
		every_in_list = {
			list = besieged_characters
			death = {
				death_reason = death_execution
				killer = root
			}
		}
		title:b_starpike.holder = {
			death = {
				death_reason = death_execution
				killer = root
			}
		}
		get_title = title:c_starpike
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_3 }
		}
	}
}

agot_peake_uprising.0007 = { # The Storming of Starpike - Maekar dies

	title = agot_peake_uprising.0007.t
	desc = agot_peake_uprising.0007.desc
	theme = battle
	left_portrait = {
		character = root
		animation = aggressive_mace
		outfit_tags = {
			valyrian_armor
		}
	}
	right_portrait = {
		character = character:Peake_66
		animation = aggressive_axe
		outfit_tags = {
			stormlander_armor
		}
	}


	immediate = {
		title:b_starpike = {
			save_scope_as = location
		}
		scope:location.holder = {
			save_scope_as = lordpeake
		}
		scope:location.holder = {
			if = {
				limit = {
					location = scope:location.title_province
					NOR = {
						exists = commanding_army
						exists = knight_army
						is_imprisoned = yes
					}
				}
				add_to_list = besieged_characters
			}
			every_courtier_or_guest = {
				limit = {
					location = scope:location.title_province
					NOR = {
						exists = commanding_army
						exists = knight_army
						is_imprisoned = yes
					}
				}
				add_to_list = besieged_characters
			}
		}
		title:b_starpike.holder = {
			save_scope_as = peake
		}
	}
	option = { # Argh!
		name = agot_peake_uprising.0007.a
		trigger_event = {
			id = agot_peake_uprising.0009
		}
	}
}



agot_peake_uprising.0008 = { # The Storming of Starpike - Aegon assumes command

	title = agot_peake_uprising.0008.t
	desc = agot_peake_uprising.0008.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_compassionate
		outfit_tags = {
			valyrian_armor
		}
	}
	right_portrait = {
		character = title:b_starpike.holder
		animation = aggressive_axe
		outfit_tags = {
			stormlander_armor
		}
	}


	immediate = {
		title:b_starpike.holder = { save_scope_as = peake }
		character:Targaryen_110 = { save_scope_as = maekar }
	}


	option = { # There has been enough bloodshed
		name = agot_peake_uprising.0008.a
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_historic_outcome_3 }
		}
	}

	option = { # Take Lord Peake's head
		name = agot_peake_uprising.0008.b
		add_dread = medium_dread_gain
		title:b_starpike.holder = {
			death = {
				death_reason = death_execution
				killer = root
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_3 }
		}
	}

	option = { # Kill them all!
		name = agot_peake_uprising.0008.c
		add_dread = massive_dread_gain
		add_stress = major_stress_gain
		get_title = title:c_starpike
		every_in_list = {
			list = besieged_characters
			death = {
				death_reason = death_execution
				killer = root
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_3 }
		}
	}
}

agot_peake_uprising.0009 = { #The Great Council of 233

	title = agot_peake_uprising.0009.t
	desc = agot_peake_uprising.0009.desc
	theme = diplomacy

	override_background = {
		reference = agot_iron_throne
	}

	immediate = {
		hidden_effect = {
			character:Targaryen_122 = { save_scope_as = eggclaimant }
			character:Targaryen_120 = { save_scope_as = aemonclaimant }
			character:Targaryen_125 = { save_scope_as = maegorclaimant }
			character:Targaryen_124 = { save_scope_as = vaellaclaimant }
			character:Blackfyre_7 = { save_scope_as = aenysclaimant }
			character:Targaryen_110 = { save_scope_as = maekardead }
			character:Targaryen_125 = { remove_trait = disinherited }
		}
	}

	left_portrait = {
		character = character:Targaryen_120
		animation = personality_honorable
	}
	right_portrait = {
		character = character:Targaryen_122
		animation = personality_compassionate
	}
	lower_left_portrait = {
		character = character:Targaryen_124
	}
	lower_center_portrait = {
		character = character:Blackfyre_7
	}
	lower_right_portrait = {
		character = character:Targaryen_125
	}
	option = {
		name = agot_peake_uprising.0009.a
		set_designated_heir = character:Targaryen_122
		death = {
			death_reason = death_siege
		}
		character:Targaryen_122 = {
			trigger_event = {
				id = agot_peake_uprising.0008
				days = 2
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_historic_outcome_5 }
		}
	}
	option = {
		name = agot_peake_uprising.0009.b
		hidden_effect = {
			scope:aemonclaimant = { remove_trait = maester }
		}
		set_designated_heir = character:Targaryen_120
		death = {
			death_reason = death_siege
		}
		character:Targaryen_120 = {
			trigger_event = {
				id = agot_peake_uprising.0008
				days = 2
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_5 }
		}
	}
	option = {
		name = agot_peake_uprising.0009.c
		agot_set_designated_heir  = {
			TARGET_HEIR = character:Targaryen_125
            TARGET_PARENT = character:Targaryen_110
        }
		death = {
			death_reason = death_siege
		}
		character:Targaryen_125 = {
			trigger_event = {
				id = agot_peake_uprising.0008
				days = 2
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_5 }
		}
	}
	option = {
		name = agot_peake_uprising.0009.d
		agot_set_designated_heir  = {
			TARGET_HEIR = character:Targaryen_124
            TARGET_PARENT = character:Targaryen_110
        }
		death = {
			death_reason = death_siege
		}
		character:Targaryen_124 = {
			trigger_event = {
				id = agot_peake_uprising.0008
				days = 2
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_5 }
		}
	}
	option = {
		name = agot_peake_uprising.0009.e
		agot_set_designated_heir  = {
			TARGET_HEIR = character:Blackfyre_7
            TARGET_PARENT = character:Targaryen_110
        }
		death = {
			death_reason = death_siege
		}
		character:Blackfyre_7 = {
			remove_character_modifier = spirit_of_sapphire_hair_dye
			trigger_event = {
				id = agot_peake_uprising.0010 # Blackfyre rewards Peake
				days = 2
			}
			trigger_event = {
				id = agot_peake_uprising.0014 # Golden Company Returns?
				days = 7
			}
		}
		ai_chance = {
			base = 0 # Outcome Weight
			modifier = { add = agot_nonhistoric_outcome_5 }
		}
	}
}

agot_peake_uprising.0010 = { # Blackfyre Assumes Control - Rewards Peake

	title = agot_peake_uprising.0010.t
	desc = agot_peake_uprising.0010.desc
	theme = diplomacy
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = title:b_starpike.holder
		animation = personality_content
	}
	override_background = {
		reference = agot_iron_throne
	}

	immediate = {
		title:b_starpike.holder = { save_scope_as = peake }
	}

	option = { # They have proven their loyalty time and again...
		name = agot_peake_uprising.0010.a
		title:c_starpike.holder = {
			add_prestige = 1500
			get_title = title:c_whitegrove
			get_title = title:c_dunstonbury
			get_title = title:d_palemarch
			get_title = title:c_burkley
			release_from_prison = yes
			trigger_event = {
				id = agot_peake_uprising.0013 # Notify Peake
			}
		}
		create_title_and_vassal_change = {
			type = granted
			save_scope_as = change
			add_claim_on_loss = no
		}
		title:d_cockleswhent = {
			change_title_holder_include_vassals = {
				holder = title:c_starpike.holder
				change = scope:change
			}
		}
		title:d_palemarch = {
			change_title_holder_include_vassals = {
				holder = title:c_starpike.holder
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
		ai_chance = {
			base = 100
		}
	}

	option = { # Who are you again? Do nothing.
		name = agot_peake_uprising.0010.b
		ai_chance = {
			base = 0
		}
	}
}

agot_peake_uprising.0011 = { # Peake Notified of Maekar's Death

	title = agot_peake_uprising.0011.t
	desc = agot_peake_uprising.0011.desc
	theme = battle
	left_portrait = {
		character = root
		animation = shock
		outfit_tags = {
			stormlander_armor
		}
	}
	right_portrait = {
		character = character:Targaryen_110
		animation = severelywounded
	}

	immediate = {
		character:Targaryen_110 = { save_scope_as = maekar }
	}

	option = { # Pray for mercy...
		name = agot_peake_uprising.0011.a
	}
}

agot_peake_uprising.0012 = { # Peake Notified of Maekar's Survival

	title = agot_peake_uprising.0012.t
	desc = agot_peake_uprising.0012.desc
	theme = battle
	left_portrait = {
		character = root
		animation = shock
		outfit_tags = {
			stormlander_armor
		}
	}
	right_portrait = {
		character = character:Targaryen_110
		animation = aggressive_mace
	}

	immediate = {
		character:Targaryen_110 = { save_scope_as = maekar }
	}

	option = { # Pray for mercy...
		name = agot_peake_uprising.0012.a
	}
}

agot_peake_uprising.0013 = { # Peake is Rewarded

	title = agot_peake_uprising.0013.t
	desc = agot_peake_uprising.0013.desc
	theme = diplomacy
	left_portrait = {
		character = title:e_the_iron_throne.holder
		animation = personality_bold
	}
	right_portrait = {
		character = root
		animation = personality_content
	}
	override_background = {
		reference = agot_iron_throne
	}
	immediate = {
		character:Blackfyre_7 = { save_scope_as = aenys }
	}

	option = { # The Gods are good...
		name = agot_peake_uprising.0013.a
	}
}

agot_peake_uprising.0014 = { # The Golden Company

	title = agot_peake_uprising.0014.t
	desc = agot_peake_uprising.0014.desc
	theme = diplomacy
	left_portrait = {
		character = root
		animation = personality_content
	}
	right_portrait = {
		character = title:d_laamp_merc_golden_company.holder
		animation = personality_vengeful
	}
	override_background = {
		reference = agot_iron_throne
	}

	immediate = {
		title:d_laamp_merc_golden_company.holder = {
			save_scope_as = bittersteel
		}
	}

	option = { # I shall send an envoy
		name = agot_peake_uprising.0014.a
		scope:bittersteel = {
			trigger_event = {
				id = agot_peake_uprising.0015
				days = 7
			}
		}
		ai_chance = {
			base = 100
		}
	}
	option = { # It is not worth the effort
		name = agot_peake_uprising.0014.b
		ai_chance = {
			base = 0
		}
	}
}

agot_peake_uprising.0015 = { # The Golden Company - Bittersteel

	title = agot_peake_uprising.0015.t
	desc = agot_peake_uprising.0015.desc
	theme = diplomacy
	left_portrait = {
		character = title:e_the_iron_throne.holder
		animation = personality_content
	}
	right_portrait = {
		character = root
		animation = personality_vengeful
	}
	override_background = {
		reference = agot_iron_throne
	}

	immediate = {
		character:Blackfyre_7 = { save_scope_as = aenys }
	}

	option = { # Accept
		name = agot_peake_uprising.0015.a
		custom_tooltip = agot_peake_uprising.0015.a.tt
		title:e_the_iron_throne.holder = {
			trigger_event = {
				id = agot_peake_uprising.0016
				days = 7
			}
		}
		ai_chance = {
			base = 75
		}
	}
	option = { # Deny
		name = agot_peake_uprising.0015.b
		custom_tooltip = agot_peake_uprising.0015.b.tt
		title:e_the_iron_throne.holder = {
			trigger_event = {
				id = agot_peake_uprising.0017
				days = 7
			}
		}
		ai_chance = {
			base = 25
		}
	}
}

agot_peake_uprising.0016 = { # The Golden Company - Return

	title = agot_peake_uprising.0016.t
	desc = agot_peake_uprising.0016.desc
	theme = diplomacy
	left_portrait = {
		character = root
		animation = personality_content
	}
	right_portrait = {
		character = character:Targaryen_95
		animation = personality_honorable
	}
	artifact = {
        target = scope:blackfyre
        position = lower_right_portrait
    }
	override_background = {
		reference = agot_iron_throne
	}

	immediate = {
		title:d_laamp_merc_golden_company.holder = {
			random_character_artifact = {
				limit = {
					has_artifact_modifier = vs_blackfyre_modifier
				}
				save_scope_as = blackfyre
			}
			agot_depose_effect = yes
		}
	}

	option = {
		name = agot_peake_uprising.0016.a
		character:Targaryen_95 = {
			set_employer = root
		}
		character:Blackfyre_3 = {
			set_employer = root
		}
		scope:blackfyre = {
			set_owner = {
				target = character:Blackfyre_7
				history = {
					actor = character:Targaryen_95
					recipient = character:Blackfyre_7
					type = given
				}
			}
		}
	}
}

agot_peake_uprising.0017 = { # The Golden Company - RBittersteel Refuses

	title = agot_peake_uprising.0017.t
	desc = agot_peake_uprising.0017.desc
	theme = diplomacy
	left_portrait = {
		character = root
		animation = disapproval
	}
	right_portrait = {
		character = character:Targaryen_95
		animation = personality_vengeful
	}
	override_background = {
		reference = agot_iron_throne
	}

	option = {
		name = agot_peake_uprising.0017.a
	}
}


