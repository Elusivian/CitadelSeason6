namespace = agot_health_events

# Old Character may be losing their sight
agot_health_events.1000 = {
	type = character_event
	title = agot_health_events.1000.t

	desc = agot_health_events.1000.desc

	left_portrait = {
		character = root
		animation = worry
	}
	theme = physical_health

	trigger = {
		NOT = {
			OR = {
				has_trait = aged
				has_trait = blind
				has_trait = half_blind
				has_character_flag = had_eye_sight_scare
			}
		}
		OR = {
			age >= 60
			AND = {
				age >= 50
				OR = {
					has_trait = physique_bad
					has_trait = spindly
					has_trait = weak
				}
			}
		}
	}

	weight_multiplier = {
		base = 1

		modifier = { #Shouldn't happen randomly for healthy characters
			health >= good_health
			factor = 0
		}
		modifier = {
			health = fine_health
			factor = 0.8
		}
		modifier = {
			health <= poor_health
			factor = 5
		}
		modifier = {
			has_trait = physique_bad_2
			factor = 1.2
		}
		modifier = {
			has_trait = physique_bad_3
			factor = 1.5
		}
		modifier = {
			age < 50
			factor = 0.3
		}
		modifier = {
			age > 60
			factor = 2
		}
		modifier = {
			age > 70
			factor = 2
		}
		modifier = {
			age > 80
			factor = 3
		}
		modifier = {
			has_trait = athletic
			factor = 0.8
		}
		modifier = {
			has_trait = whole_of_body
			factor = 0.5
		}
		modifier = {
			has_trait = physique_good_1
			factor = 0.8
		}
		modifier = {
			has_trait = physique_good_2
			factor = 0.5
		}
		modifier = {
			has_trait = physique_good_3
			factor = 0.3
		}
		modifier = {
			has_serious_disease_trigger = yes
			factor = 3
		}
		modifier = {
			has_treatable_disease_trigger = yes
			factor = 1.2
		}
	}

	option = {
		name = agot_health_events.1000.a

		hidden_effect = {
			random_list = {
				40 = {
					trigger_event = {
						id = agot_health_events.1001
						days = { 3 12 }
					}
				}
				40 = {
					trigger_event = {
						id = agot_health_events.1003
						days = { 3 12 }
					}
				}
				20 = {
					add_character_flag = had_eye_sight_scare
					trigger_event = {
						id = agot_health_events.1004
						days = { 2 4 }
					}
				}
			}
		}
	}
}

# Character becomes half-blind
agot_health_events.1001 = {
	type = character_event
	title = agot_health_events.1001.t

	desc = agot_health_events.1001.desc

	left_portrait = {
		character = root
		animation = grief
	}
	theme = physical_health

	option = {
		name = agot_health_events.1001.a

		add_trait = half_blind
	}

	after = {
		hidden_effect = {
			trigger_event = {
				id = agot_health_events.1002
				days = { 120 730 }
			}
		}
	}
}

# Character loses the rest of their sight
agot_health_events.1002 = {
	type = character_event
	title = agot_health_events.1002.t

	desc = agot_health_events.1002.desc

	left_portrait = {
		character = root
		animation = sadness
	}
	theme = physical_health

	option = {
		name = agot_health_events.1002.a

		add_trait = blind
		hidden_effect = {
			make_trait_inactive = aged
			remove_trait = half_blind
		}
	}
}

# Character loses their sight
agot_health_events.1003 = {
	type = character_event
	title = agot_health_events.1003.t

	desc = agot_health_events.1003.desc

	left_portrait = {
		character = root
		animation = grief
	}
	theme = physical_health

	option = {
		name = agot_health_events.1003.a

		add_trait = blind
		make_trait_inactive = aged
	}
}

# Character has a eyesight health scare but is alright
agot_health_events.1004 = {
	type = character_event
	title = agot_health_events.1004.t

	desc = agot_health_events.1004.desc

	left_portrait = {
		character = root
		animation = admiration
	}
	theme = recovery

	option = {
		name = agot_health_events.1004.a
	}
}